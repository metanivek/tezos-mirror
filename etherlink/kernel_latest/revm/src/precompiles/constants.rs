// SPDX-FileCopyrightText: 2025 Nomadic Labs <contact@nomadic-labs.com>
// SPDX-FileCopyrightText: 2025 Functori <contact@functori.com>
//
// SPDX-License-Identifier: MIT

use revm::primitives::{Address, FixedBytes};

pub(crate) const WITHDRAWAL_SOL_CONTRACT: &str = "0x60806040526004361015610013575b61037d565b61001d5f3561004c565b806320d786b51461004757806367a32cd7146100425763cda4fee20361000e57610354565b6102f5565b6100cf565b60e01c90565b60405190565b5f80fd5b5f80fd5b5f91031261006a57565b61005c565b1c90565b90565b61008690600861008b930261006f565b610073565b90565b906100999154610076565b90565b6100a75f5f9061008e565b90565b90565b6100b6906100aa565b9052565b91906100cd905f602085019401906100ad565b565b346100ff576100df366004610060565b6100fb6100ea61009c565b6100f2610052565b918291826100ba565b0390f35b610058565b5f80fd5b5f80fd5b5f80fd5b601f801991011690565b634e487b7160e01b5f52604160045260245ffd5b9061013890610110565b810190811067ffffffffffffffff82111761015257604052565b61011a565b9061016a610163610052565b928361012e565b565b67ffffffffffffffff811161018a57610186602091610110565b0190565b61011a565b90825f939282370152565b909291926101af6101aa8261016c565b610157565b938185526020850190828401116101cb576101c99261018f565b565b61010c565b9080601f830112156101ee578160206101eb9335910161019a565b90565b610108565b67ffffffffffffffff81116102115761020d602091610110565b0190565b61011a565b9092919261022b610226826101f3565b610157565b93818552602085019082840111610247576102459261018f565b565b61010c565b9080601f8301121561026a5781602061026793359101610216565b90565b610108565b916060838303126102eb575f83013567ffffffffffffffff81116102e657826102999185016101d0565b92602081013567ffffffffffffffff81116102e157836102ba9183016101d0565b92604082013567ffffffffffffffff81116102dc576102d9920161024c565b90565b610104565b610104565b610104565b61005c565b5f0190565b61030961030336600461026f565b916108c2565b610311610052565b8061031b816102f0565b0390f35b9060208282031261034f575f82013567ffffffffffffffff811161034a5761034792016101d0565b90565b610104565b61005c565b61036761036236600461031f565b610a55565b61036f610052565b80610379816102f0565b0390f35b5f80fd5b91905f5c61039b576103969260015f5d6107ac565b5f805d565b5f80fd5b5f1c90565b6103b06103b59161039f565b610073565b90565b6103c290546103a4565b90565b5190565b60209181520190565b90825f9392825e0152565b6103fc61040560209361040a936103f3816103c5565b938480936103c9565b958691016103d2565b610110565b0190565b5190565b60209181520190565b61043a610443602093610448936104318161040e565b93848093610412565b958691016103d2565b610110565b0190565b906104916104a39597969461048360809561047561049c9560a08801908882035f8a01526103dd565b9086820360208801526103dd565b90848203604086015261041b565b9660608301906100ad565b01906100ad565b565b600360ff60981b0190565b906104c26104bd836101f3565b610157565b918252565b606090565b3d5f146104e7576104dc3d6104b0565b903d5f602084013e5b565b6104ef6104c7565b906104e5565b5f7f43616c6c20746f20746865206f7574626f782073656e646572206661696c6564910152565b610528602080926103c9565b610531816104f5565b0190565b61054a9060208101905f81830391015261051c565b90565b1561055457565b61055c610052565b62461bcd60e51b81528061057260048201610535565b0390fd5b61dead90565b905090565b61058c5f809261057c565b0190565b61059990610581565b90565b5f7f4661696c656420746f206275726e000000000000000000000000000000000000910152565b6105d0600e6020926103c9565b6105d98161059c565b0190565b6105f29060208101905f8183039101526105c3565b90565b156105fc57565b610604610052565b62461bcd60e51b81528061061a600482016105dd565b0390fd5b60200190565b69ffffffffffffffffffff191690565b61063e9051610624565b90565b1b90565b61065f61065a6106548361040e565b9261061e565b610634565b906016811061066d575b5090565b6106899069ffffffffffffffffffff1990601603600802610641565b165f610669565b61069990610624565b9052565b60018060a01b031690565b6106b19061069d565b90565b6106bd906106a8565b9052565b9695939461070861071d966106fe60a0966106f46107159760208e6106ed60c082019a5f830190610690565b01906100ad565b60408c01906100ad565b60608a01906100ad565b878203608089015261041b565b9401906106b4565b565b634e487b7160e01b5f52601160045260245ffd5b61073c906100aa565b5f19811461074a5760010190565b61071f565b5f1b90565b906107605f199161074f565b9181191691161790565b90565b61078161077c610786926100aa565b61076a565b6100aa565b90565b90565b906107a161079c6107a89261076d565b610789565b8254610754565b9055565b5f8061085e9261080234956107f36107c388610c5b565b93919389906107d1876103b8565b916107da610052565b968795600460208801631be3287960e31b81520161044c565b6020820181038252038261012e565b61080a6104a5565b9082602082019151925af16108266108206104cc565b9161054d565b6108595f80610833610576565b8661083c610052565b908161084781610590565b03925af16108536104cc565b506105f5565b610645565b6108a361086a5f6103b8565b9293429033917f62e8e01e31b83084b97c32b1b11ad5a2042382f5f65ee4106ad4a0d0f8b9942c9661089a610052565b968796876106c1565b0390a16108c06108ba6108b55f6103b8565b610733565b5f61078c565b565b906108cd9291610381565b565b5f5c6108e7576108e29060015f5d61094f565b5f805d565b5f80fd5b9291602061090761090f9360408701908782035f8901526103dd565b9401906100ad565b565b61094661094d9461093c606094989795610932608086019a5f8701906100ad565b60208501906106b4565b6040830190610690565b01906100ad565b565b5f80349261099361095f85610c5b565b9161098461096b610052565b938492600460208501631ef3b63960e21b8152016108eb565b6020820181038252038261012e565b61099b6104a5565b9082602082019151925af1906109b86109b26104cc565b9261054d565b6109eb5f806109c5610576565b846109ce610052565b90816109d981610590565b03925af16109e56104cc565b506105f5565b906109f63391610645565b91610a36610a035f6103b8565b7f2d5ad793181f5b6bd727c0c216461e019ecfe466353fdde9ccf813f45b84fa8294610a2d610052565b94859485610911565b0390a1610a53610a4d610a485f6103b8565b610733565b5f61078c565b565b610a5e906108cf565b565b5f90565b90565b610a7b610a76610a8092610a64565b61076a565b6100aa565b90565b610a9164e8d4a51000610a67565b90565b634e487b7160e01b5f52601260045260245ffd5b610ab4610aba916100aa565b916100aa565b908115610ac5570490565b610a94565b610ad6610adc916100aa565b916100aa565b908115610ae7570690565b610a94565b90565b610b03610afe610b0892610aec565b61076a565b6100aa565b90565b5f7f416d6f756e74206973207a65726f000000000000000000000000000000000000910152565b610b3f600e6020926103c9565b610b4881610b0b565b0190565b610b619060208101905f818303910152610b32565b90565b15610b6b57565b610b73610052565b62461bcd60e51b815280610b8960048201610b4c565b0390fd5b60407f657a290000000000000000000000000000000000000000000000000000000000917f526f756e64696e6720776f756c64206c6f7365207765692c20616d6f756e74205f8201527f6d757374206265206d756c7469706c65206f662031305e3132202831206d757460208201520152565b610c0d60436060926103c9565b610c1681610b8d565b0190565b610c2f9060208101905f818303910152610c00565b90565b15610c3957565b610c41610052565b62461bcd60e51b815280610c5760048201610c1a565b0390fd5b610c63610a60565b50610cc0610c7982610c73610a83565b90610aa8565b91610ca8610c8f82610c89610a83565b90610aca565b91610ca2610c9c5f610aef565b916100aa565b11610b64565b610cba610cb45f610aef565b916100aa565b14610c32565b9056fea2646970667358221220182d06b3e5b6d667c87b8a85eb0b1767d99484aa6798d88e7a7a3428f023271a64736f6c634300081d0033";

pub(crate) const FA_WITHDRAWAL_SOL_CONTRACT: &str = "0x60806040526004361015610013575b610510565b61001d5f3561005c565b806320d786b514610057578063379607f51461005257806380fc1fe31461004d5763fff7ca5f0361000e576104e0565b610366565b61015e565b6100df565b60e01c90565b60405190565b5f80fd5b5f80fd5b5f91031261007a57565b61006c565b1c90565b90565b61009690600861009b930261007f565b610083565b90565b906100a99154610086565b90565b6100b75f5f9061009e565b90565b90565b6100c6906100ba565b9052565b91906100dd905f602085019401906100bd565b565b3461010f576100ef366004610070565b61010b6100fa6100ac565b610102610062565b918291826100ca565b0390f35b610068565b5f80fd5b610121816100ba565b0361012857565b5f80fd5b9050359061013982610118565b565b9060208282031261015457610151915f0161012c565b90565b61006c565b5f0190565b61017161016c36600461013b565b610d9f565b610179610062565b8061018381610159565b0390f35b60018060a01b031690565b61019b90610187565b90565b6101a781610192565b036101ae57565b5f80fd5b905035906101bf8261019e565b565b5f80fd5b5f80fd5b601f801991011690565b634e487b7160e01b5f52604160045260245ffd5b906101f1906101c9565b810190811067ffffffffffffffff82111761020b57604052565b6101d3565b9061022361021c610062565b92836101e7565b565b67ffffffffffffffff81116102435761023f6020916101c9565b0190565b6101d3565b90825f939282370152565b9092919261026861026382610225565b610210565b938185526020850190828401116102845761028292610248565b565b6101c5565b9080601f830112156102a7578160206102a493359101610253565b90565b6101c1565b69ffffffffffffffffffff191690565b6102c5816102ac565b036102cc57565b5f80fd5b905035906102dd826102bc565b565b91909160a081840312610361576102f8835f83016101b2565b92602082013567ffffffffffffffff811161035c5781610319918401610289565b92610327826040850161012c565b9261033583606083016102d0565b92608082013567ffffffffffffffff8111610357576103549201610289565b90565b610114565b610114565b61006c565b61037d6103743660046102df565b93929092611532565b610385610062565b8061038f81610159565b0390f35b67ffffffffffffffff81116103b1576103ad6020916101c9565b0190565b6101d3565b909291926103cb6103c682610393565b610210565b938185526020850190828401116103e7576103e592610248565b565b6101c5565b9080601f8301121561040a57816020610407933591016103b6565b90565b6101c1565b9060e0828203126104db57610426815f84016101b2565b92602083013567ffffffffffffffff81116104d65782610447918501610289565b92610455836040830161012c565b9261046381606084016102d0565b92608083013567ffffffffffffffff81116104d15782610484918501610289565b9260a081013567ffffffffffffffff81116104cc57836104a59183016103ec565b9260c082013567ffffffffffffffff81116104c7576104c49201610289565b90565b610114565b610114565b610114565b610114565b61006c565b6104fa6104ee36600461040f565b959490949391936119a8565b610502610062565b8061050c81610159565b0390f35b5f80fd5b5f5c61052c576105279060015f5d610ad4565b5f805d565b5f80fd5b600460ff60981b0190565b9061054d61054883610225565b610210565b918252565b606090565b3d5f14610572576105673d61053b565b903d5f602084013e5b565b61057a610552565b90610570565b60209181520190565b5f7f436f756c64206e6f742066696e64206465706f73697400000000000000000000910152565b6105bd6016602092610580565b6105c681610589565b0190565b6105df9060208101905f8183039101526105b0565b90565b156105e957565b6105f1610062565b62461bcd60e51b815280610607600482016105ca565b0390fd5b5f80fd5b9050519061061c82610118565b565b9050519061062b8261019e565b565b919060c0838203126106af576106a89061064760c0610210565b93610654825f830161060f565b5f860152610665826020830161061e565b6020860152610677826040830161061e565b6040860152610689826060830161060f565b606086015261069b826080830161060f565b608086015260a00161060f565b60a0830152565b61060b565b9060c0828203126106cd576106ca915f0161062d565b90565b61006c565b5190565b6106e09051610192565b90565b6106ed90516100ba565b90565b6106f990610192565b9052565b60409061072661072d949695939661071c60608401985f8501906106f0565b60208301906100bd565b01906100bd565b565b60209181520190565b90825f9392825e0152565b61076261076b60209361077093610759816106d2565b9384809361072f565b95869101610738565b6101c9565b0190565b916107979261078a60408201935f8301906106f0565b6020818403910152610743565b90565b5f90565b5f7f53797374656d20666f72776172646572206661696c6564000000000000000000910152565b6107d26017602092610580565b6107db8161079e565b0190565b6107f49060208101905f8183039101526107c5565b90565b156107fe57565b610806610062565b62461bcd60e51b81528061081c600482016107df565b0390fd5b151590565b61082e81610820565b0361083557565b5f80fd5b9050519061084682610825565b565b9092919261085d61085882610225565b610210565b938185526020850190828401116108795761087792610738565b565b6101c5565b9080601f8301121561089c5781602061089993519101610848565b90565b6101c1565b9190916040818403126108e1576108ba835f8301610839565b92602082015167ffffffffffffffff81116108dc576108d9920161087e565b90565b610114565b61006c565b60409061090f610916949695939661090560608401985f8501906100bd565b60208301906106f0565b01906100bd565b565b60407f756e7375636365737366756c0000000000000000000000000000000000000000917f4661696c656420746f20696e6372656d656e74207469636b65742062616c616e5f8201527f63653a207469636b65745f62616c616e63655f6164642063616c6c207761732060208201520152565b610998604c606092610580565b6109a181610918565b0190565b6109ba9060208101905f81830391015261098b565b90565b156109c457565b6109cc610062565b62461bcd60e51b8152806109e2600482016109a5565b0390fd5b90565b6109fd6109f8610a02926100ba565b6109e6565b6100ba565b90565b90959492610a5094610a3f610a4992610a35608096610a2b60a088019c5f8901906106f0565b60208701906106f0565b60408501906100bd565b60608301906100bd565b01906100bd565b565b5f7f436f756c64206e6f742072656d6f7665206465706f7369740000000000000000910152565b610a866018602092610580565b610a8f81610a52565b0190565b610aa89060208101905f818303910152610a79565b90565b15610ab257565b610aba610062565b62461bcd60e51b815280610ad060048201610a93565b0390fd5b5f80610d5c610d6b610d8c94610b568480610b0d610b1c85610af4610062565b928391600460208401630ad83b9d60e11b8152016100ca565b602082018103825203826101e7565b610b24610530565b9082602082019151925af1610b40610b3a610557565b916105e2565b6020610b4b826106d2565b8183010191016106b4565b610c318580610b67602085016106d6565b610bb5610b758387016106e3565b91610ba6610b85606089016106e3565b610b8d610062565b948593600460208601630efe6a8b60e01b8152016106fd565b602082018103825203826101e7565b610bf7610bc4604087016106d6565b610be8610bcf610062565b9384926004602085016337d6e7b960e11b815201610774565b602082018103825203826101e7565b610bff61079a565b9082602082019151925af1610c1b610c15610557565b916107f7565b6020610c26826106d2565b8183010191016108a1565b508514610d8e57610c44604082016106d6565b5b610cba8680610c56606086016106e3565b610c998591610c8a610c69858a016106e3565b610c71610062565b94859360046020860163f9d70f6960e01b8152016108e6565b602082018103825203826101e7565b610ca1610530565b9082602082019151925af1610cb4610557565b506109bd565b610cc6606083016106e3565b90610cd3602084016106d6565b90610d38610ce28986016106e3565b94610cfb60a0610cf4608084016106e3565b92016106e3565b90610d267f7ee7a1de9c18ce695c95b8b19fbdf26cce3544e3ca9e08c9f487776783d7599f966109e9565b96610d2f610062565b95869586610a05565b0390a2610d43610062565b92839160046020840163029b6f6360e31b8152016100ca565b602082018103825203826101e7565b610d73610530565b9082602082019151925af1610d86610557565b50610aab565b565b610d9a602082016106d6565b610c45565b610da890610514565b565b939291905f5c610dc657610dc19460015f5d6112f1565b5f805d565b5f80fd5b90565b610de1610ddc610de692610dca565b6109e6565b6100ba565b90565b60207f6400000000000000000000000000000000000000000000000000000000000000917f456d707479207769746864726177616c7320617265206e6f7420616c6c6f77655f8201520152565b610e436021604092610580565b610e4c81610de9565b0190565b610e659060208101905f818303910152610e36565b90565b15610e6f57565b610e77610062565b62461bcd60e51b815280610e8d60048201610e50565b0390fd5b90565b610ea0610ea5916102ac565b610e91565b9052565b905090565b610ed3610eca92602092610ec1816106d2565b94858093610ea9565b93849101610738565b0190565b80610ee8601692610eef9594610e94565b0190610eae565b90565b60200190565b5f1c90565b610f09610f0e91610ef8565b6109e9565b90565b610f1d610f2291610ef8565b610083565b90565b610f2f9054610f11565b90565b634e487b7160e01b5f52601160045260245ffd5b610f4f906100ba565b5f198114610f5d5760010190565b610f32565b5f1b90565b90610f735f1991610f62565b9181191691161790565b90565b90610f95610f90610f9c926109e9565b610f7d565b8254610f67565b9055565b60407f617320756e7375636365737366756c0000000000000000000000000000000000917f4661696c656420746f2064656372656d656e74207469636b65742062616c616e5f8201527f63653a207469636b65745f62616c616e63655f72656d6f76652063616c6c207760208201520152565b611020604f606092610580565b61102981610fa0565b0190565b6110429060208101905f818303910152611013565b90565b1561104c57565b611054610062565b62461bcd60e51b81528061106a6004820161102d565b0390fd5b611077906102ac565b9052565b906110bf9492936110a861109d6110b29360808601908682035f880152610743565b9560208501906100bd565b604083019061106e565b6060818403910152610743565b90565b600360ff60981b0190565b60407f75636365737366756c0000000000000000000000000000000000000000000000917f4661696c656420746f2070726f64756365206d6573736167653a20707573685f5f8201527f66615f7769746864726177616c5f746f5f6f7574626f782063616c6c20756e7360208201520152565b61114d6049606092610580565b611156816110cd565b0190565b61116f9060208101905f818303910152611140565b90565b1561117957565b611181610062565b62461bcd60e51b8152806111976004820161115a565b0390fd5b905051906111a8826102bc565b565b91906040838203126111e4576111dd906111c46040610210565b936111d1825f830161119b565b5f86015260200161119b565b6020830152565b61060b565b90604082820312611202576111ff915f016111aa565b90565b61006c565b61121190516102ac565b90565b919461125c6112669298979561125260a09661124861126d9a61123e60c08a019e5f8b01906106f0565b60208901906106f0565b604087019061106e565b606085019061106e565b60808301906100bd565b01906100bd565b565b5f7f50726f7879207769746864726177206661696c65640000000000000000000000910152565b6112a36015602092610580565b6112ac8161126f565b0190565b6112c59060208101905f818303910152611296565b90565b156112cf57565b6112d7610062565b62461bcd60e51b8152806112ed600482016112b0565b0390fd5b93929192835f61130090610dcd565b9061130a906100ba565b1161131490610e68565b828161131e610062565b918291602083019161132f92610ed7565b60208201810382520361134290826101e7565b61134b816106d2565b9061135590610ef2565b2061135f90610efd565b926113695f610f25565b926113735f610f25565b61137c90610f46565b611386905f610f80565b84878791611392610062565b9283926020840163d93ad06360e01b8152600401926113b0936108e6565b6020820181038252036113c390826101e7565b6113cb610530565b6020820191515a925f8094938194f16113e2610557565b506113ec90611045565b8591926113f7610062565b9384936020850163e9f58a7760e01b8152600401936114159461107b565b60208201810382520361142890826101e7565b6114306110c2565b6020820191515a925f8094938194f1611447610557565b9061145190611172565b61145a816106d2565b6020820101906020019061146d916111e9565b8290338690825f0161147e90611207565b9260200161148b90611207565b94877fab68450c9e546f6062a861eebf8ec5bbd41b4425e26b20199c91227c7f9038ca956114b8906109e9565b966114c1610062565b9586956114ce9587611214565b0390a2339190916114dd610062565b92839260208401635ae2fb3960e11b8152600401926114fb936106fd565b60208201810382520361150e90826101e7565b906020820191515a925f8094938194f1611526610557565b50611530906112c8565b565b9061153f94939291610daa565b565b9594939291905f5c61155f5761155a9660015f5d61175a565b5f805d565b5f80fd5b5190565b61158661158f6020936115949361157d81611563565b93848093610580565b95869101610738565b6101c9565b0190565b9796946115ea61160e979360c0966115dd6116069760408e6115d66115cb6115f89a60e08401908482035f860152610743565b9660208301906100bd565b019061106e565b8b820360608d0152610743565b9089820360808b0152611567565b9087820360a0890152610743565b9401906100bd565b565b60407f6c20756e7375636365737366756c000000000000000000000000000000000000917f4661696c656420746f2070726f64756365206d6573736167653a20707573685f5f8201527f666173745f66615f7769746864726177616c5f746f5f6f7574626f782063616c60208201520152565b611690604e606092610580565b61169981611610565b0190565b6116b29060208101905f818303910152611683565b90565b156116bc57565b6116c4610062565b62461bcd60e51b8152806116da6004820161169d565b0390fd5b95939196949290966101008701975f88016116f8916106f0565b60208701611705916106f0565b604086016117129161106e565b6060850161171f9161106e565b6080840161172c916100bd565b60a08301611739916100bd565b60c08201611746916100bd565b8082039060e0015261175791610743565b90565b95929493909194855f61176c90610dcd565b90611776906100ba565b1161178090610e68565b808261178a610062565b918291602083019161179b92610ed7565b6020820181038252036117ae90826101e7565b6117b7816106d2565b906117c190610ef2565b206117cb90610efd565b946117d55f610f25565b936117df5f610f25565b6117e890610f46565b6117f2905f610f80565b868989916117fe610062565b9283926020840163d93ad06360e01b81526004019261181c936108e6565b60208201810382520361182f90826101e7565b611837610530565b6020820191515a925f8094938194f161184e610557565b5061185890611045565b908792939086908692611869610062565b9687966020880163164faff760e31b81526004019661188797611598565b60208201810382520361189a90826101e7565b6118a26110c2565b6020820191515a925f8094938194f16118b9610557565b906118c3906116b5565b6118cc816106d2565b602082010190602001906118df916111e9565b8391338791835f016118f090611207565b936020016118fd90611207565b9588914291927f7e40c982e82bccb5e8bbd29f38bcfa3996f341ef9f51e2a9cffe086ec87a11c79761192e906109e9565b98611937610062565b97889761194497896116de565b0390a233919091611953610062565b92839260208401635ae2fb3960e11b815260040192611971936106fd565b60208201810382520361198490826101e7565b906020820191515a925f8094938194f161199c610557565b506119a6906112c8565b565b906119b7969594939291611541565b56fea264697066735822122041503064fd8ed95c8e42eb738a623c9ce70538f005c8bba160478965c0e7ad9764736f6c634300081d0033";

pub(crate) const INTERNAL_FORWARDER_SOL_CONTRACT: &str = "0x60806040526004361015610010575b005b61001a5f35610029565b636fadcf720361000e57610197565b60e01c90565b60405190565b5f80fd5b5f80fd5b5f80fd5b60018060a01b031690565b61005590610041565b90565b6100618161004c565b0361006857565b5f80fd5b9050359061007982610058565b565b5f80fd5b5f80fd5b5f80fd5b909182601f830112156100c15781359167ffffffffffffffff83116100bc5760200192600183028401116100b757565b610083565b61007f565b61007b565b919091604081840312610107576100df835f830161006c565b92602082013567ffffffffffffffff8111610102576100fe9201610087565b9091565b61003d565b610039565b151590565b61011a9061010c565b9052565b5190565b60209181520190565b90825f9392825e0152565b601f801991011690565b61015f61016860209361016d936101568161011e565b93848093610122565b9586910161012b565b610136565b0190565b916101949261018760408201935f830190610111565b6020818403910152610140565b90565b346101c9576101b06101aa3660046100c6565b916103e5565b906101c56101bc61002f565b92839283610171565b0390f35b610035565b5f90565b606090565b600260ff60981b0190565b60209181520190565b60207f63616c6c65720000000000000000000000000000000000000000000000000000917f496e7465726e616c466f727761726465723a20756e617574686f72697a6564205f8201520152565b61024560266040926101e2565b61024e816101eb565b0190565b6102679060208101905f818303910152610238565b90565b1561027157565b61027961002f565b62461bcd60e51b81528061028f60048201610252565b0390fd5b906102c3949392916102be336102b86102b26102ad6101d7565b61004c565b9161004c565b1461026a565b6103b5565b9091565b905090565b90825f939282370152565b9091826102e7816102ee936102c7565b80936102cc565b0190565b90916102fd926102d7565b90565b634e487b7160e01b5f52604160045260245ffd5b9061031e90610136565b810190811067ffffffffffffffff82111761033857604052565b610300565b9061035061034961002f565b9283610314565b565b67ffffffffffffffff81116103705761036c602091610136565b0190565b610300565b9061038761038283610352565b61033d565b918252565b3d5f146103a75761039c3d610375565b903d5f602084013e5b565b6103af6101d2565b906103a5565b5f94919285949385925050926103d56103cc61002f565b938492836102f2565b03925af16103e161038c565b9091565b9061040192916103f36101ce565b6103fb6101d2565b90610293565b909156fea2646970667358221220d5097227fa62b2533a977713064491da57191217e74d82101e2ed068996af89b64736f6c634300081d0033";

pub(crate) const WITHDRAWAL_SOL_ADDR: Address = Address(FixedBytes::new([
    0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x01,
]));

pub(crate) const FA_WITHDRAWAL_SOL_ADDR: Address = Address(FixedBytes::new([
    0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x02,
]));

pub(crate) const WITHDRAWAL_SOL_CODE_HASH: FixedBytes<32> = FixedBytes::new([
    0x83, 0x1c, 0x3c, 0xec, 0xcc, 0x7a, 0x5c, 0x55, 0x1d, 0x5a, 0x28, 0xd1, 0xdd, 0x32,
    0x93, 0x61, 0xd6, 0x1d, 0x33, 0x95, 0xe7, 0x8a, 0xfb, 0x8d, 0x31, 0x42, 0xf6, 0x3e,
    0x9d, 0x24, 0x50, 0x8b,
]);

pub(crate) const FA_WITHDRAWAL_SOL_CODE_HASH: FixedBytes<32> = FixedBytes::new([
    0xca, 0x78, 0x4a, 0xaa, 0x36, 0x43, 0x0e, 0x87, 0xe4, 0xf0, 0xfd, 0x51, 0x24, 0xfa,
    0x94, 0xc7, 0xfe, 0xbc, 0xbc, 0xd0, 0xe2, 0xe5, 0x3a, 0xf8, 0xc5, 0x01, 0x42, 0xfd,
    0x6b, 0x20, 0x25, 0xb9,
]);

pub(crate) const INTERNAL_FORWARDER_SOL_CODE_HASH: FixedBytes<32> = FixedBytes::new([
    0xa6, 0xe5, 0xcd, 0x80, 0xfc, 0x8a, 0x09, 0x47, 0xcf, 0x9f, 0x85, 0x2b, 0x21, 0x88,
    0x4c, 0x42, 0x5d, 0xeb, 0x36, 0xc3, 0x48, 0x0b, 0xe1, 0x62, 0x5c, 0xb9, 0xdf, 0x31,
    0xc5, 0xd7, 0xad, 0x0e,
]);

pub(crate) const SEND_OUTBOX_MESSAGE_PRECOMPILE_ADDRESS: Address =
    Address(FixedBytes::new([
        0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03,
    ]));

pub(crate) const TABLE_PRECOMPILE_ADDRESS: Address = Address(FixedBytes::new([
    0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x04,
]));

#[cfg(test)]
pub(crate) const PRECOMPILE_BURN_ADDRESS: Address = Address(FixedBytes::new([
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0xde, 0xad,
]));

pub(crate) const CUSTOMS: [Address; 4] = [
    WITHDRAWAL_SOL_ADDR,
    FA_WITHDRAWAL_SOL_ADDR,
    SEND_OUTBOX_MESSAGE_PRECOMPILE_ADDRESS,
    TABLE_PRECOMPILE_ADDRESS,
];

// Rationale regarding the cost:
// A few decoding/encoding functions.
pub(crate) const SEND_OUTBOX_MESSAGE_BASE_COST: u64 = 500;

// Rationale regarding the cost:
// Covers the cost of 2 r/w access on cold keys.
pub(crate) const TICKET_TABLE_BASE_COST: u64 = 5000;

#[cfg(test)]
mod test {
    use super::{
        FA_WITHDRAWAL_SOL_CODE_HASH, FA_WITHDRAWAL_SOL_CONTRACT,
        INTERNAL_FORWARDER_SOL_CODE_HASH, INTERNAL_FORWARDER_SOL_CONTRACT,
        WITHDRAWAL_SOL_CODE_HASH, WITHDRAWAL_SOL_CONTRACT,
    };

    use crate::helpers::storage::bytes_hash;
    use revm::{
        primitives::{hex::FromHex, Bytes, FixedBytes},
        state::Bytecode,
    };

    fn check_code_hash_validity(code: &str, code_hash_voucher: FixedBytes<32>) {
        let bytecode = Bytecode::new_legacy(Bytes::from_hex(code).unwrap());
        let code_hash = bytes_hash(bytecode.original_byte_slice());
        // Keep this until the script is updated
        println!(
            "{:?}",
            code_hash
                .iter()
                .map(|e| format!("0x{e:02x}"))
                .collect::<Vec<String>>()
                .join(", ")
        );
        assert_eq!(code_hash, code_hash_voucher)
    }

    #[test]
    fn check_withdrawal_sol_code_hash() {
        check_code_hash_validity(WITHDRAWAL_SOL_CONTRACT, WITHDRAWAL_SOL_CODE_HASH)
    }

    #[test]
    fn check_fa_withdrawal_sol_code_hash() {
        check_code_hash_validity(FA_WITHDRAWAL_SOL_CONTRACT, FA_WITHDRAWAL_SOL_CODE_HASH)
    }

    #[test]
    fn check_internal_forwarder_sol_code_hash() {
        check_code_hash_validity(
            INTERNAL_FORWARDER_SOL_CONTRACT,
            INTERNAL_FORWARDER_SOL_CODE_HASH,
        )
    }
}
